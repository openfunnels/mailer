jQuery(document).ready(function(g){var h=g("#mailster_nonce").val(),m=g(".mailster-setup-step"),b,a,e=g(".status"),n=g(".spinner"),f=location.hash.substr(1);if(f&&g("#step_"+f).length){b=g("#step_"+f)}else{b=m.eq(0)}a=b.attr("id").replace(/^step_/,"");m.hide();o(a);g("form.mailster-setup-step-form").on("submit",function(){g(".next-step:visible").hide();return false});g("a.external").on("click",function(){if(this.href){window.open(this.href)}return false});g("#mailster-setup").on("click",".validation-skip-step",function(){return confirm(mailsterL10n.skip_validation)}).on("click",".next-step",function(){if(g(this).hasClass("disabled")){return false}if(tinymce){tinymce.get("post_content").save()}var p=g(this).parent().parent().find("form"),q=p.serialize();i("wizard_save",{id:a,data:q},function(r){})}).on("click",".load-language",function(){e.html(mailsterL10n.load_language);n.css("visibility","visible");i("load_language",function(p){n.css("visibility","hidden");e.html(p.html);if(p.success){location.reload()}});return false}).on("click",".quick-install",function(){var p=g(this);d(p.data("plugin"),p.data("method"),p.parent())}).on("click",".edit-slug",function(){g(this).parent().parent().find("span").hide().filter(".edit-slug-area").show().find("input").focus().select()});g(document).on("verified.mailster",function(){g(".validation-next-step").removeClass("disabled");g(".validation-skip-step").addClass("disabled")});c();var l=g("#deliverynav"),k=g(".deliverytab");l.on("click","a.nav-tab",function(){l.find("a").removeClass("nav-tab-active");k.hide();var p=g(this).addClass("nav-tab-active").attr("href").substr(1);g("#deliverymethod").val(p);g("#deliverytab-"+p).show();if(g("#deliverytab-"+p).find(".quick-install").length){g(".delivery-next-step").addClass("disabled").html(j(mailsterL10n.enable_first,g(this).html()))}else{g(".delivery-next-step").removeClass("disabled").html(j(mailsterL10n.use_deliverymethod,g(this).html()))}return false});function c(){e.html(mailsterL10n.check_language);n.css("visibility","visible");i("check_language",function(p){n.css("visibility","hidden");e.html(p.html);if(p.success){}})}function o(q){var p=g("#step_"+q);if(p.length){b.hide();b=p;b.show();a=q}}g(window).on("hashchange",function(){var s=location.hash.substr(1)||"start",r=g(".mailster-setup-steps-nav").find("a[href='#"+s+"']"),p,q;if(r.length){o(s);r.parent().parent().find("a").removeClass("next prev current");r.parent().prevAll().find("a").addClass("prev");r.addClass("current");if(tinymce&&tinymce.activeEditor){tinymce.activeEditor.theme.resizeTo("100%",200)}}if("finish"==s){i("wizard_save",{id:s,data:null})}}).trigger("hashchange");function d(q,s,p,r){e.html(mailsterL10n.install_addon);n.css("visibility","visible");i("quick_install",{plugin:q,method:s,step:"install"},function(t){e.html(mailsterL10n.activate_addon);i("quick_install",{plugin:q,method:s,step:"activate"},function(u){e.html(mailsterL10n.receiving_content);i("quick_install",{plugin:q,method:s,step:"content"},function(v){e.html("");n.css("visibility","hidden");p.html(v.content);l.find("a.nav-tab-active").trigger("click")})})})}function j(){var p=Array.prototype.slice.call(arguments),t=p.shift(),s=p.length,r;for(var q=0;q<s;q++){r=new RegExp("%("+(q+1)+"\\$)?(s|d|f)");t=t.replace(r,p[q])}return t}function i(r,q,s,p){if(g.isFunction(q)){if(g.isFunction(s)){p=s}s=q;q={}}g.ajax({type:"POST",url:ajaxurl,data:g.extend({action:"mailster_"+r,_wpnonce:h},q),success:function(u,v,t){s&&s.call(this,u,v,t)},error:function(t,v,u){if(v=="error"&&!u){return}if(console){console.error(g.trim(t.responseText))}p&&p.call(this,t,v,u)},dataType:"JSON"})}});