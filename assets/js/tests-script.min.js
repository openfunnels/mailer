jQuery(document).ready(function(h){var i=h("#mailster_nonce").val(),d=h("#singletest").val()||null,o=h(".start-test"),f=h(".tests-output"),c=h(".tests-textoutput"),e=h(".tests-wrap"),g=h(".test-info"),b=h("#progress"),j=b.find(".bar"),a=h("#outputnav"),p=h(".subtab"),q,l;h("a.external").on("click",function(){if(this.href){window.open(this.href)}return false});o.on("click",function(){o.hide();b.show();f.empty();c.val(c.data("pretext"));l=1;m(d);q={error:0,warning:0,notice:0,success:0};return false});f.on("click","a",function(){if(this.className.match(/retest/)){return true}if(this.href){window.open(this.href)}return false});e.on("change","input",function(){(h(this).is(":checked"))?e.removeClass("no-"+h(this).data("type")):e.addClass("no-"+h(this).data("type"))});a.on("click","a.nav-tab",function(){a.find("a").removeClass("nav-tab-active");p.hide();var s=h(this).addClass("nav-tab-active").attr("href");location.hash=s;h("#subtab-"+s.substr(1)).show();if(s=="#systeminfo"){var r=h("#system_info_content");if(h.trim(r.val())){return}r.val("...");k("get_system_info",function(t){if(t.log&&console){console.log(t.log)}r.val(t.msg)})}return false});if(/autostart/.test(location.search)){o.trigger("click")}else{(location.hash&&a.find('a[href="'+location.hash+'"]').length)?a.find('a[href="'+location.hash+'"]').trigger("click"):a.find("a").eq(0).trigger("click")}function m(r){k("test",{test_id:r},function(s){q.error+=s.errors.error;q.warning+=s.errors.warning;q.notice+=s.errors.notice;q.success+=s.errors.success;h(s.message.html).appendTo(f);c.val(c.val()+s.message.text);if(s.nexttest&&!d){j.width(((++l)/s.total*100)+"%");g.html(n(mailsterL10n.running_test,l,s.total,s.next))}else{j.width("100%");setTimeout(function(){o.html(mailsterL10n.restart_test).show();b.hide();j.width(0);g.html(n(mailsterL10n.tests_finished,q.error,q.warning,q.notice))},500)}if(s.nexttest&&!d){setTimeout(function(){m(s.nexttest)},100)}else{}},function(s,u,t){})}function n(){var r=Array.prototype.slice.call(arguments),v=r.shift(),u=r.length,t;for(var s=0;s<u;s++){t=new RegExp("%("+(s+1)+"\\$)?(s|d|f)");v=v.replace(t,r[s])}return v}function k(t,s,u,r){if(h.isFunction(s)){if(h.isFunction(u)){r=u}u=s;s={}}h.ajax({type:"POST",url:ajaxurl,data:h.extend({action:"mailster_"+t,_wpnonce:i},s),success:function(w,x,v){u&&u.call(this,w,x,v)},error:function(v,x,w){if(x=="error"&&!w){return}if(console){console.error(h.trim(v.responseText))}r&&r.call(this,v,x,w)},dataType:"JSON"})}});