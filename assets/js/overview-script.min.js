jQuery(document).ready(function(c){if(typeof wp=="undefined"||!wp.heartbeat){return}var d=[],a=false,b=c("tr.type-newsletter");c(".column-status").on("click","a.live-action",function(){if(c(this).hasClass("finish")&&!confirm(mailsterL10n.finish_campaign)){return false}var f=c(this).parent().parent().parent().addClass("loading");c.get(c(this).attr("href"),function(){setTimeout(function(){wp.heartbeat.connectNow()},500)});return false});c(document).on("scroll",function(){clearTimeout(a);a=setTimeout(function(){wp.heartbeat.connectNow()},400)}).on("heartbeat-send",function(h,g){var f=[],i;b.each(function(){i=parseInt(c(this).find("input").eq(0).val(),10);d[i]=d[i]||{};if(e(this)){f.push(i)}});g.mailster={page:"overview",ids:f}}).on("heartbeat-tick",function(h,g){var j=false;if(g.mailster){if(!d){d=c.extend(g.mailster,d);j=true}var k=false,f=0;c.each(b,function(m,i){var l;i=c(i);m=i.attr("id").replace("post-","");i.removeClass("loading");if(!g.mailster[m]){return}l=g.mailster[m];i.find(".column-status")[l.cron?"removeClass":"addClass"]("cron-issue");i.find(".campaign-status").html(l.cron?"":l.status_title);c.each(l,function(o,s){if(!j&&d[m][o]==s){return}var r=d[m]&&d[m].status&&(l.status!=d[m].status||l.is_active!=d[m].is_active);switch(o){case"status":if(r){i.removeClass("status-"+d[m].status).addClass("status-"+l.status)}case"sent":case"total":case"sent_formatted":break;case"column-status":if(l.status=="active"&&!r){var n=i.find(".campaign-progress"),t=(l.sent/l.total*100);n.find(".bar").width(t+"%");n.find("span").eq(1).html(l.sent_formatted);n.find("span").eq(2).html(l.sent_formatted);n.find("var").html(Math.round(t)+"%")}if(!r){break}default:var q=i.find("."+o);if(!q.is(":visible")){break}q.fadeTo(10,0.01,function(){q.html(s).delay(10*(f++)).fadeTo(200,1)})}k=true})});if(k){wp.heartbeat.interval("fast")}d=c.extend(d,g.mailster)}});wp.heartbeat.interval("fast");if(wp.heartbeat.connectNow){wp.heartbeat.connectNow()}function e(f,h){var g=f.getBoundingClientRect();if(!h){h=0}return(g.top+h>=0&&g.top-h<=(window.innerHeight||document.documentElement.clientHeight))}});