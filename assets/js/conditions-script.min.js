jQuery(document).ready(function(b){b.each(b(".mailster-conditions"),function(){var e=b(this),h=e.find(".mailster-conditions-wrap"),d=e.find(".mailster-condition-group"),f=e.find(".mailster-condition");d.eq(0).appendTo(e.find(".mailster-condition-container"));g();e.on("click",".add-condition",function(){var j=d.length,i=d.eq(0).clone();i.removeAttr("id").appendTo(h).data("id",j).show();b.each(i.find("input, select"),function(){var l=b(this),k=l.attr("name");l.attr("name",k.replace(/\[\d+\]/,"["+j+"]")).prop("disabled",false)});i.find(".condition-field").val("").focus();g();d=e.find(".mailster-condition-group");f=e.find(".mailster-condition")}).on("click",".add-or-condition",function(){var i=b(this).parent(),k=i.find(".mailster-condition").last().data("id"),j=f.eq(0).clone();j.removeAttr("id").appendTo(i).data("id",++k);b.each(j.find("input, select"),function(){var m=b(this),l=m.attr("name");m.attr("name",l.replace(/\[\d+\]\[\d+\]/,"["+i.data("id")+"]["+k+"]")).prop("disabled",false)});j.find(".condition-field").val("").focus();g();f=e.find(".mailster-condition")});h.on("click",".remove-condition",function(){var i=b(this).parent();if(i.parent().find(".mailster-condition").length==1){i=i.parent()}i.slideUp(100,function(){b(this).remove();a("updateCount")})}).on("change",".condition-field",function(){var l=b(this).closest(".mailster-condition"),j=b(this).val(),k,i;l.find("div.mailster-conditions-value-field").removeClass("active").find(".condition-value").prop("disabled",true);l.find("div.mailster-conditions-operator-field").removeClass("active").find(".condition-operator").prop("disabled",true);i=l.find('div.mailster-conditions-value-field[data-fields*=",'+j+',"]').addClass("active").find(".condition-value").prop("disabled",false);k=l.find('div.mailster-conditions-operator-field[data-fields*=",'+j+',"]').addClass("active").find(".condition-operator").prop("disabled",false);if(!i.length){i=l.find("div.mailster-conditions-value-field-default").addClass("active").find(".condition-value").prop("disabled",false)}if(!k.length){k=l.find("div.mailster-conditions-operator-field-default").addClass("active").find(".condition-operator").prop("disabled",false)}if(!i.val()){if(i.is(".hasDatepicker")){i.datepicker("setDate","yy-mm-dd")}}a("updateCount")}).on("change",".condition-operator",function(){a("updateCount")}).on("change",".condition-value",function(){a("updateCount")}).on("click",".mailster-condition-add-multiselect",function(){b(this).parent().clone().insertAfter(b(this).parent()).find(".condition-value").select().focus();return false}).on("click",".mailster-condition-remove-multiselect",function(){b(this).parent().remove();a("updateCount");return false}).on("change",".mailster-conditions-value-field-multiselect > .condition-value",function(){if(0==b(this).val()&&b(this).parent().parent().find(".condition-value").size()>1){b(this).parent().remove()}}).on("click",".mailster-rating > span",function(k){var l=b(this),i=l.prevAll(),j=l.siblings();j.removeClass("enabled");i.add(l).addClass("enabled");l.parent().parent().find(".condition-value").val((i.length+1)/5).trigger("change")}).find(".condition-field").prop("disabled",false).trigger("change");a("updateCount");function g(){h.find(".datepicker").datepicker({dateFormat:"yy-mm-dd",firstDay:mailsterL10n.start_of_week,showWeek:true,dayNames:mailsterL10n.day_names,dayNamesMin:mailsterL10n.day_names_min,monthNames:mailsterL10n.month_names,prevText:mailsterL10n.prev,nextText:mailsterL10n.next,showAnim:"fadeIn"})}});function c(){var d=Array.prototype.slice.call(arguments),h=d.shift(),g=d.length,f;for(var e=0;e<g;e++){f=new RegExp("%("+(e+1)+"\\$)?(s|d|f)");h=h.replace(f,d[e])}return h}function a(){if(!window.Mailster){return}var e=jQuery.makeArray(arguments);var d=e.shift();window.Mailster.trigger(d,e)}});